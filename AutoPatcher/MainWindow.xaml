<Window x:Class="AutoPatcher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AutoPatcher"
        mc:Ignorable="d"
        Title="AutoPatch [ Version 1.0.0 ]" Height="650" Width="1075">
    <Window.Resources>
        <!-- Grouping Data by Group -->
        <CollectionViewSource x:Key="GroupedData" Source="{Binding DataGridItems}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Group" />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </Window.Resources>
    <Grid>
        <StackPanel Orientation="Vertical">
            <StackPanel Orientation="Horizontal" Margin="10,0,0,0">
                <RadioButton x:Name="rdLF"  FontSize="15" VerticalContentAlignment="Center" Content="LF"  Margin="0,5,0,0" GroupName="Mode" Checked="Radiobutton_Checked" IsChecked="{Binding Path=ModeArray[0],Mode=TwoWay}"></RadioButton>
                <RadioButton x:Name="rdSII" FontSize="15" VerticalContentAlignment="Center" Content="SII" Margin="5,5,0,0" GroupName="Mode" Checked="Radiobutton_Checked" IsChecked="{Binding Path=ModeArray[1],Mode=TwoWay}"></RadioButton>
                <RadioButton x:Name="rdBGA" FontSize="15" VerticalContentAlignment="Center" Content="BGA" Margin="5,5,0,0" GroupName="Mode" Checked="Radiobutton_Checked" IsChecked="{Binding Path=ModeArray[2],Mode=TwoWay}"></RadioButton>
                <RadioButton x:Name="rdCOB" FontSize="15" VerticalContentAlignment="Center" Content="COB" Margin="5,5,0,0" GroupName="Mode" Checked="Radiobutton_Checked" IsChecked="{Binding Path=ModeArray[3],Mode=TwoWay}"></RadioButton>                
            </StackPanel>
            <DataGrid x:Name="DataGrid"
                  AutoGenerateColumns="False"
                  IsReadOnly="False"
                  CanUserAddRows="False"
                  Margin="10,5,10,0"
                  HorizontalScrollBarVisibility="Auto"
                  VerticalScrollBarVisibility="Auto"
                  HeadersVisibility="Column"
                  Height="250"
                  ItemsSource="{Binding Path=Groups, Source={StaticResource GroupedData}}" >
                
                <DataGrid.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.HeaderTemplate>
                            <DataTemplate>
                                <!-- Group Header Template -->
                                <TextBlock Text="{Binding Name}" FontWeight="Bold" Padding="5" />
                            </DataTemplate>
                        </GroupStyle.HeaderTemplate>
                    </GroupStyle>
                </DataGrid.GroupStyle>

                <DataGrid.Columns>                    
                    <!-- Other Columns -->
                    <DataGridTextColumn Header="Group" Binding="{Binding Group}" Width="100" />


                    <!--<DataGridTextColumn Header="Server" Binding="{Binding Server}" Width="150" />
                    <DataGridTextColumn Header="Local IP" Binding="{Binding LocalIP}" Width="120" />-->
                    <DataGridTextColumn Header="Machine" Binding="{Binding InspectionUnit}" Width="120" />
                    <!--<DataGridTextColumn Header="Main IP" Binding="{Binding PC1}" Width="120" />-->
                    <DataGridTemplateColumn Header="Main">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding MainSelected}" Name="chkMain" Checked="CheckBox_Checked" Unchecked="CheckBox_Checked" ></CheckBox>
                                    <TextBlock Text="{Binding PC1}" Width="120"></TextBlock>                                    
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <!--<DataGridTextColumn Header="Vision1 IP" Binding="{Binding PC2}" Width="120" />-->
                    <DataGridTemplateColumn Header="Vision 1">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding V1Selected}" Name="chkV1" Checked="CheckBox_Checked" Unchecked="CheckBox_Checked"></CheckBox>
                                    <TextBlock Text="{Binding PC2}" Width="120"></TextBlock>                                    
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <!--<DataGridTextColumn Header="Vision2 IP" Binding="{Binding PC3}" Width="120" />-->
                    <DataGridTemplateColumn Header="Vision 2">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding V2Selected}" Name="chkV2" Checked="CheckBox_Checked" Unchecked="CheckBox_Checked"></CheckBox>
                                    <TextBlock Text="{Binding PC3}" Width="120"></TextBlock>                                    
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <!--<DataGridTextColumn Header="Vision3 IP" Binding="{Binding PC4}" Width="120" />-->
                    <DataGridTemplateColumn Header="Vision 3">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding V3Selected}" Name="chkV3" Checked="CheckBox_Checked" Unchecked="CheckBox_Checked"></CheckBox>
                                    <TextBlock Text="{Binding PC4}" Width="120"></TextBlock>                                    
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    
                </DataGrid.Columns>
            </DataGrid>
            <StackPanel Orientation="Horizontal" Margin="10,5,0,0">
                <RadioButton Name="rdMain"   Checked="Radiobutton_Checked" GroupName="PCType"  VerticalContentAlignment="Center" FontSize="15" Content="Main" Margin="5,0,0,0"></RadioButton>
                <RadioButton Name="rdVision" Checked="Radiobutton_Checked" GroupName="PCType"  VerticalContentAlignment="Center" FontSize="15" Content="Vision" Margin="5,0,0,0"></RadioButton>
                <Label FontSize="15" Content="Process :" Margin="10,0,0,0"></Label>
                <Label x:Name="lblProcName" FontSize="15" Content="-" Margin="0,0,0,0"></Label>
            </StackPanel>
            <!-- ListBox to Display Files -->
            <ListBox x:Name="FileListBox" Margin="10,0,0,0" Height="200" />

            <StackPanel Orientation="Vertical" Margin="10,10,0,0">
                
                <!--select excel-->
                <StackPanel Orientation="Horizontal" Height="30" Margin="5,5,0,0">
                    <Button x:Name="btnLoadExcel"
                    Content="Load Excel" Width="80" Height="30"
                    VerticalAlignment="Top" 
                    HorizontalAlignment="Left"
                    Click = "btnLoadExcel_Click"
                    FontSize="13"/>
                    <Label x:Name="lblCurExcel" Content="D:\" Margin="12,0,0,0"/>
                </StackPanel>

                <!--set patch folder-->
                <StackPanel Orientation="Horizontal" Margin="5,5,0,0" >
                    <!-- Button to Select Folder -->
                    <Button x:Name="SelectFolderButton" 
                Content="Patch Folder"                 
                Width="80" 
                Height="30"                  
                VerticalAlignment="Top" 
                HorizontalAlignment="Left"
                Click="SelectFolderButton_Click" 
                FontSize="13"/>
                    <Label x:Name="lblCurDir" Content="D:\" Margin="13,0,0,0"/>
                </StackPanel>
                
                <!--run patch-->                
                <StackPanel Orientation="Horizontal" Height="30" Margin="5,5,0,0">
                    <Button x:Name="btnRunPatch" Content="Apply" Width="80" Height="30"  
                VerticalAlignment="Top" 
                HorizontalAlignment="Left" Click="btnRunPatch_Click"/>
                    <Label Name="lblStatus" FontSize="14" Content="Status : " Margin="12,0,0,0"></Label>
                </StackPanel>                    
                
                
            </StackPanel>
        </StackPanel>
        
        
        
        
    </Grid>
</Window>